{"ast":null,"code":"import { createAsyncThunk, createSlice, createSelector } from '@reduxjs/toolkit';\nimport { request } from '../../config/fetchConfig';\nimport { STORAGE_NAME } from '../../services/constants';\nconst initialState = {\n  token: null,\n  userId: null,\n  error: null,\n  isLoading: false\n};\nexport const login = createAsyncThunk('auth/login', async (_ref, _ref2) => {\n  let {\n    email,\n    password\n  } = _ref;\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const response = await request('/api/auth/login', 'POST', {\n      email,\n      password\n    });\n    localStorage.setItem(STORAGE_NAME, JSON.stringify({\n      userId: response.data.userId,\n      token: response.data.token\n    }));\n    return response.data;\n  } catch (err) {\n    let error = err;\n\n    if (!error.response) {\n      throw err;\n    }\n\n    return rejectWithValue(error.response.data);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: {\n      reducer: state => {\n        state.token = null;\n        state.userId = null;\n        localStorage.removeItem(STORAGE_NAME);\n      }\n    },\n    getAuthLocalStorage: {\n      reducer: (state, action) => {\n        state.token = action.payload.token;\n        state.userId = action.payload.userId;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.isLoading = true;\n    });\n    builder.addCase(login.fulfilled, (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      state.token = payload.token;\n      state.userId = payload.userId;\n      state.error = null;\n      state.isLoading = false;\n    });\n    builder.addCase(login.rejected, (state, action) => {\n      if (action.payload) {\n        state.error = action.payload;\n        state.isLoading = false;\n      } else {\n        state.error = action.error.message;\n        state.isLoading = false;\n      }\n    });\n  }\n});\n\nconst selectAuthState = state => state.auth;\n\nexport const selectorAuth = createSelector(selectAuthState, state => ({\n  token: state.token,\n  userId: state.userId,\n  error: state.error,\n  isLoading: state.isLoading\n}));\nexport const {\n  logout,\n  getAuthLocalStorage\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/artem/mern/client/src/store/authentification/auth.slice.js"],"names":["createAsyncThunk","createSlice","createSelector","request","STORAGE_NAME","initialState","token","userId","error","isLoading","login","email","password","rejectWithValue","response","localStorage","setItem","JSON","stringify","data","err","authSlice","name","reducers","logout","reducer","state","removeItem","getAuthLocalStorage","action","payload","extraReducers","builder","addCase","pending","fulfilled","rejected","message","selectAuthState","auth","selectorAuth","actions"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice, createSelector } from '@reduxjs/toolkit';\nimport { request } from '../../config/fetchConfig';\nimport { STORAGE_NAME } from '../../services/constants';\n\nconst initialState = {\n  token: null,\n  userId: null,\n  error: null,\n  isLoading: false,\n};\n\nexport const login = createAsyncThunk('auth/login', async ({ email, password }, { rejectWithValue }) => {\n  try {\n    const response = await request('/api/auth/login', 'POST', { email, password });\n    localStorage.setItem(STORAGE_NAME, JSON.stringify({ userId: response.data.userId, token: response.data.token }));\n\n    return response.data;\n  } catch (err) {\n    let error = err;\n\n    if (!error.response) {\n      throw err;\n    }\n\n    return rejectWithValue(error.response.data);\n  }\n});\n\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: {\n      reducer: state => {\n        state.token = null;\n        state.userId = null;\n        localStorage.removeItem(STORAGE_NAME);\n      },\n    },\n    getAuthLocalStorage: {\n      reducer: (state, action) => {\n        state.token = action.payload.token;\n        state.userId = action.payload.userId;\n      },\n    },\n  },\n  extraReducers: builder => {\n    builder.addCase(login.pending, state => {\n      state.isLoading = true;\n    });\n    builder.addCase(login.fulfilled, (state, { payload }) => {\n      state.token = payload.token;\n      state.userId = payload.userId;\n      state.error = null;\n      state.isLoading = false;\n    });\n    builder.addCase(login.rejected, (state, action) => {\n      if (action.payload) {\n        state.error = action.payload;\n        state.isLoading = false;\n      } else {\n        state.error = action.error.message;\n        state.isLoading = false;\n      }\n    });\n  },\n});\n\nconst selectAuthState = state => state.auth;\n\nexport const selectorAuth = createSelector(selectAuthState, state => ({\n  token: state.token,\n  userId: state.userId,\n  error: state.error,\n  isLoading: state.isLoading,\n}));\n\nexport const { logout, getAuthLocalStorage } = authSlice.actions;\n\nexport default authSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}