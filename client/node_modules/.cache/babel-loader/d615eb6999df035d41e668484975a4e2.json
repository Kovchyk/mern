{"ast":null,"code":"import { createAsyncThunk, createSlice, createSelector } from '@reduxjs/toolkit';\nimport { request } from '../../config/fetchConfig';\nimport { STORAGE_NAME } from '../../services/constants';\nconst initialState = {\n  token: null,\n  userId: null\n};\nexport const login = createAsyncThunk('auth/login', async (_ref, _ref2) => {\n  let {\n    email,\n    password\n  } = _ref;\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const response = await request('/api/auth/login', 'POST', {\n      email,\n      password\n    });\n    localStorage.setItem(STORAGE_NAME, JSON.stringify({\n      userId: response.data.userId,\n      token: response.data.token\n    }));\n    return response.data;\n  } catch (err) {\n    let error = err;\n\n    if (!error.response) {\n      throw err;\n    }\n\n    console.log(error);\n    return rejectWithValue(error.response.data);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: {\n      reducer: state => {\n        state.token = null;\n        state.userId = null;\n        localStorage.removeItem(STORAGE_NAME);\n      }\n    },\n    getAuthLocalStorage: {\n      reducer: (state, action) => {\n        state.token = action.payload.token;\n        state.userId = action.payload.userId;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.fulfilled, (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      state.token = payload.token;\n      state.userId = payload.userId;\n    });\n    builder.addCase(login.rejected, (state, action) => {\n      if (action.payload) {\n        state.error = action.payload;\n      } else {\n        state.error = action.error.message;\n      }\n    });\n  }\n});\n\nconst selectAuthState = state => state.auth;\n\nexport const selectorAuth = createSelector(selectAuthState, state => ({\n  token: state.token,\n  userId: state.userId\n}));\nexport const {\n  logout,\n  getAuthLocalStorage\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/artem/mern/client/src/store/authentification/auth.slice.js"],"names":["createAsyncThunk","createSlice","createSelector","request","STORAGE_NAME","initialState","token","userId","login","email","password","rejectWithValue","response","localStorage","setItem","JSON","stringify","data","err","error","console","log","authSlice","name","reducers","logout","reducer","state","removeItem","getAuthLocalStorage","action","payload","extraReducers","builder","addCase","fulfilled","rejected","message","selectAuthState","auth","selectorAuth","actions"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice, createSelector } from '@reduxjs/toolkit';\nimport { request } from '../../config/fetchConfig';\nimport { STORAGE_NAME } from '../../services/constants';\n\nconst initialState = {\n  token: null,\n  userId: null,\n};\n\nexport const login = createAsyncThunk('auth/login', async ({ email, password }, { rejectWithValue }) => {\n  try {\n    const response = await request('/api/auth/login', 'POST', { email, password });\n    localStorage.setItem(STORAGE_NAME, JSON.stringify({ userId: response.data.userId, token: response.data.token }));\n\n    return response.data;\n  } catch (err) {\n    let error = err;\n\n    if (!error.response) {\n      throw err;\n    }\n    console.log(error);\n    return rejectWithValue(error.response.data);\n  }\n});\n\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: {\n      reducer: state => {\n        state.token = null;\n        state.userId = null;\n        localStorage.removeItem(STORAGE_NAME);\n      },\n    },\n    getAuthLocalStorage: {\n      reducer: (state, action) => {\n        state.token = action.payload.token;\n        state.userId = action.payload.userId;\n      },\n    },\n  },\n  extraReducers: builder => {\n    builder.addCase(login.fulfilled, (state, { payload }) => {\n      state.token = payload.token;\n      state.userId = payload.userId;\n    });\n    builder.addCase(login.rejected, (state, action) => {\n      if (action.payload) {\n        state.error = action.payload;\n      } else {\n        state.error = action.error.message;\n      }\n    });\n  },\n});\n\nconst selectAuthState = state => state.auth;\n\nexport const selectorAuth = createSelector(selectAuthState, state => ({\n  token: state.token,\n  userId: state.userId,\n}));\n\nexport const { logout, getAuthLocalStorage } = authSlice.actions;\n\nexport default authSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}